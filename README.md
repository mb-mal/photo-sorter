# PhotoSorter

AI-–∞—Å—Å–∏—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ Ollama –∏ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Qdrant. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏, —Å–æ–∑–¥–∞–≤–∞—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫—É—é —Ç–∞–∫—Å–æ–Ω–æ–º–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è**: –ú–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω—ã–π AI-–ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è —Ç–æ—á–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
- **–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CLIP-—ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- **EXIF –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ**: –£—á–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∫–∞–º–µ—Ä—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ —Å—ä–µ–º–∫–∏
- **99.99% —Ç–æ—á–Ω–æ—Å—Ç—å**: –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Ö–æ–∂–∏—Ö —Ñ–æ—Ç–æ

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.13+
- Ollama —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª—å—é
- Qdrant (–ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä)
- ~40GB —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –¥–ª—è –º–æ–¥–µ–ª–µ–π

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/mb-mal/photo-sorter.git
cd photo-sorter
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è Python

```bash
python3 -m venv .
source bin/activate  # Linux/macOS
# –∏–ª–∏
.\Scripts\activate  # Windows
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ Qdrant

**Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**

```bash
docker run -p 6333:6333 -p 6334:6334 qdrant/qdrant
```

**–ò–ª–∏ –ª–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞:**

```bash
# macOS
brew install qdrant

# Linux
wget https://github.com/qdrant/qdrant/releases/latest/download/qdrant-x86_64-unknown-linux-gnu.tar.gz
tar -xzf qdrant-x86_64-unknown-linux-gnu.tar.gz
./qdrant
```

Qdrant –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:6333`

### 5. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Ollama

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞ Ollama:**

```bash
# macOS/Linux
curl -fsSL https://ollama.ai/install.sh | sh

# Windows
# –°–∫–∞—á–∞–π—Ç–µ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ —Å https://ollama.ai/download
```

**–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏:**

```bash
ollama pull gemma3:27b-it-qat
```

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–æ–¥–µ–ª–∏:

- `gemma3:27b-it-qat` - –±—ã—Å—Ç—Ä–∞—è –∏ —Ç–æ—á–Ω–∞—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `qwen3-vl:32b` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å

### 6. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

```bash
mkdir img  # –ò—Å—Ö–æ–¥–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
mkdir sorted_photos  # –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ (—Å–æ–∑–¥–∞—Å—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
```

–ü–æ–º–µ—Å—Ç–∏—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `img/`.

## üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
source bin/activate
python photo_sorter.py
```

### –° —É–∫–∞–∑–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–∏

```bash
python photo_sorter.py --model gemma3:27b-it-qat
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–æ—Ç–æ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

```bash
python photo_sorter.py --limit 10
```

### –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (–±–µ–∑ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤)

```bash
python photo_sorter.py --dry-run
```

### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–æ–±—Ä–∞–±–æ—Ç–∫–∞

```bash
python photo_sorter.py --force
```

### –£–∫–∞–∑–∞–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

```bash
python photo_sorter.py --source /path/to/photos --destination /path/to/output
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

- **`img/`** ‚Äî –∏—Å—Ö–æ–¥–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **`sorted_photos/`** ‚Äî –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º:
  - `business/` ‚Äî —Ä–∞–±–æ—á–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
    - `diagrams/` ‚Äî –≥—Ä–∞—Ñ–∏–∫–∏ –∏ —Å—Ö–µ–º—ã
    - `events/` ‚Äî —Å–æ–±—ã—Ç–∏—è –∏ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏
    - `receipts/` ‚Äî —á–µ–∫–∏ –∏ –±–∏–ª–µ—Ç—ã
    - `travel/` ‚Äî –¥–µ–ª–æ–≤—ã–µ –ø–æ–µ–∑–¥–∫–∏
    - `none/` ‚Äî –ø—Ä–æ—á–∏–µ –±–∏–∑–Ω–µ—Å-—Ñ–æ—Ç–æ
  - `personal/` ‚Äî –ª–∏—á–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
    - `pets/` ‚Äî –¥–æ–º–∞—à–Ω–∏–µ –∂–∏–≤–æ—Ç–Ω—ã–µ
    - `school/` ‚Äî —É—á–µ–±–∞
    - `misc/` ‚Äî –ø—Ä–æ—á–µ–µ
  - `sightseeing/` ‚Äî —Ç—É—Ä–∏–∑–º –∏ –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    - `architecture/` ‚Äî –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
    - `landmarks/` ‚Äî –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –º–µ—Å—Ç–∞
    - `cityscape/` ‚Äî –≥–æ—Ä–æ–¥—Å–∫–∏–µ –ø–µ–π–∑–∞–∂–∏

## üõ†Ô∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä  | –û–ø–∏—Å–∞–Ω–∏–µ                                                                           | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é       |
| ----------------- | ------------------------------------------------------------------------------------------ | ----------------------------- |
| `--source`      | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –∏—Å—Ö–æ–¥–Ω—ã–º–∏ —Ñ–æ—Ç–æ                                        | `img`                       |
| `--destination` | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ                        | `sorted_photos`             |
| `--model`       | –ú–æ–¥–µ–ª—å Ollama                                                                        | `gemma3:27b-it-qat`         |
| `--temperature` | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏—è (0.0 = –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ) | `0.0`                       |
| `--limit`       | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–æ—Ç–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏           | –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π |
| `--force`       | –ü–µ—Ä–µ–æ–±—Ä–∞–±–æ—Ç–∫–∞ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ                        | `false`                     |
| `--dry-run`     | –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º (–±–µ–∑ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤)                   | `false`                     |
| `--verbose`     | –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ                                                  | `false`                     |

## üîÑ –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è

–î–ª—è –æ—á–∏—Å—Ç–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –≤–æ–∑–≤—Ä–∞—Ç–∞ —Ñ–æ—Ç–æ –≤ –∏—Å—Ö–æ–¥–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:

```bash
./reset.sh
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:

- –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç –≤—Å–µ —Ñ–æ—Ç–æ –∏–∑ `sorted_photos/` –æ–±—Ä–∞—Ç–Ω–æ –≤ `img/`
- –û—á–∏—Å—Ç–∏—Ç SQLite –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
- –£–¥–∞–ª–∏—Ç –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –≤ Qdrant

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:

1. **STEP 0**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ Ollama
2. **STEP 1**: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–ø-—É—Ä–æ–≤–Ω–µ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (business/personal/sightseeing)
3. **STEP 2**: –í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö —Ñ–æ—Ç–æ –≤ Qdrant
4. **STEP 3**: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ/—Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å —É—á–µ—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- **EmbeddingService**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è CLIP-—ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ (768-dim, ViT-L-14)
- **VectorIndex**: –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Qdrant –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –ø–æ–∏—Å–∫–∞
- **IntelligentClassifier**: –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –º–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **PhotoRepository**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SQLite –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
pytest tests/
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å —Ü–≤–µ—Ç–Ω–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π:

- üîµ –°–∏–Ω–∏–π ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- üü¢ –ó–µ–ª–µ–Ω—ã–π ‚Äî —É—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- üü° –ñ–µ–ª—Ç—ã–π ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- üî¥ –ö—Ä–∞—Å–Ω—ã–π ‚Äî –æ—à–∏–±–∫–∏

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

Licensed under the Apache License, Version 2.0. See [LICENSE](LICENSE) file for details.
